<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1NTDDp-Ow6-HTgChNrH85WpWpw80EMEA-ZpjpgYe674k/export?format=csv";

async function verify() {
  const input = document.getElementById("memberId");
  const output = document.getElementById("output");
  const id = input.value.trim();

  if (!id) {
    output.innerHTML = "<div class='result EXPELLED'>PLEASE ENTER MEMBER ID</div>";
    return;
  }

  try {
    const res = await fetch(SHEET_URL);
    const text = await res.text();

    const rows = text.trim().split("\n").slice(1);
    let found = false;

    rows.forEach(row => {
      const cols = row.replace(/\r/g, "").split(",");

      const memberId = cols[0]?.trim();

      if (memberId === id) {
        found = true;

        const [
          _id,
          fullName,
          codeName,
          gt,
          dateSurvive,
          status,
          remark,
          position
        ] = cols;

        output.innerHTML = `
          <div class="result ${status}">
            <strong>Status: ${status}</strong><br><br>
            <b>Full Name:</b> ${fullName}<br>
            <b>Alexis / Medusa Name:</b> ${codeName}<br>
            <b>GT:</b> ${gt}<br>
            <b>Position:</b> ${position}<br>
            <b>Date Survive:</b> ${dateSurvive}<br>
            <b>Remarks:</b> ${remark}
          </div>
        `;
      }
    });

    if (!found) {
      output.innerHTML = "<div class='result EXPELLED'>MEMBER NOT FOUND</div>";
    }

  } catch (err) {
    output.innerHTML = "<div class='result EXPELLED'>ERROR LOADING DATA</div>";
    console.error(err);
  }
}
</script>
